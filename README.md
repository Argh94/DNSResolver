# DNSResolver

یک ابزار ساده و کاربردی به زبان **پایتون** برای پیدا کردن آدرس‌های IP (IPv4 و IPv6) دامنه‌ها با استفاده از پروتکل DNS. این پروژه با ارسال درخواست به سرور DNS (مثل 1.1.1.1 از Cloudflare) آدرس IP دامنه‌ها را پیدا می‌کند و به شما نمایش می‌دهد.

## نویسنده
این پروژه توسط **argh94** نوشته شده است.

## عملکرد کد
این برنامه یک **DNS Resolver** است که:
- از کاربر سه دامنه (مثل google.com) می‌گیرد.
- برای هر دامنه، درخواست‌های DNS برای پیدا کردن آدرس‌های IPv4 (رکورد A) و IPv6 (رکورد AAAA) به سرور DNS می‌فرستد.
- نتایج را به‌صورت همزمان (با استفاده از threading) پردازش می‌کند.
- دامنه‌ها را قبل از ارسال بررسی می‌کند تا مطمئن شود معتبرند.
- اگر سرور DNS پاسخ ندهد، تا سه بار دوباره امتحان می‌کند (retry).

### ویژگی‌های کلیدی
- **پشتیبانی از IPv4 و IPv6**: برای هر دامنه، هم آدرس IPv4 و هم IPv6 را پیدا می‌کند (اگر موجود باشد).
- **اعتبارسنجی دامنه**: با استفاده از regex، مطمئن می‌شود دامنه‌ها معتبرند (مثلاً google.com معتبر است، ولی invalid@domain معتبر نیست).
- **تلاش دوباره**: اگر درخواست به سرور DNS ناموفق باشد، تا ۳ بار دوباره امتحان می‌کند.
- **اجرای همزمان**: با استفاده از threading، می‌تواند چند دامنه را به‌صورت همزمان پردازش کند.
- **مدیریت خطاها**: خطاهایی مانند تایم‌اوت یا پاسخ‌های نامعتبر را به‌خوبی مدیریت می‌کند.

## قسمت‌های مهم کد
- **کلاس `DNSResolver`**: هسته اصلی برنامه که منطق رفع نام دامنه را پیاده می‌کند.
  - `__init__`: تنظیمات اولیه مانند تعداد تلاش‌ها (retries) و Semaphore برای محدود کردن threadها.
  - `is_valid_domain`: بررسی می‌کند که دامنه معتبر باشد.
  - `build_dns_query`: بسته DNS را برای ارسال به سرور می‌سازد.
  - `parse_dns_response`: پاسخ DNS را تجزیه می‌کند و آدرس IP (IPv4 یا IPv6) را استخراج می‌کند.
  - `resolve_domain`: درخواست‌ها را به سرور DNS می‌فرستد و نتایج را ذخیره می‌کند.
- **تابع `main`**: ورودی کاربر (دامنه‌ها) را می‌گیرد، threadها را راه‌اندازی می‌کند، و نتایج را نمایش می‌دهد.

## وابستگی‌ها
این پروژه از **کتابخانه‌های استاندارد پایتون** استفاده می‌کند و هیچ وابستگی خارجی ندارد:
- `socket`: برای ارتباط شبکه‌ای با سرور DNS
- `struct`: برای بسته‌بندی و باز کردن داده‌های DNS
- `threading`: برای اجرای همزمان درخواست‌ها
- `random`: برای تولید شناسه تراکنش تصادفی
- `re`: برای اعتبارسنجی دامنه‌ها با regex

**نکته**: اگر بخواهید از کتابخانه `dnspython` استفاده کنید (برای رفع نام دامنه ساده‌تر)، باید آن را نصب کنید:
```bash
pip install dnspython
```

## نیازمندی‌های پروژه
- پایتون: نسخه ۳.۶ یا بالاتر
- دسترسی به اینترنت: برای ارسال درخواست به سرور DNS (پیش‌فرض: 1.1.1.1 از Cloudflare)
- سیستم‌عامل: ویندوز، لینوکس یا مک (هر سیستمی که پایتون روی آن کار کند)
- (اختیاری) افزونه cSpell در ویرایشگر کد (مثل VS Code) برای استفاده از فایل .cspell.json

## ساختار پروژه

```
DNSResolver/
├── dns_resolver.py        # کد اصلی پروژه
├── .cspell.json           # تنظیمات cSpell برای کلمات تخصصی
├── README.md              # توضیحات پروژه (این فایل)
```

### توضیحات فایل تنظیمات پروژه

#### .cspell.json
این فایل برای ابزار cSpell (بررسی املای کلمات در کد) تنظیم شده و کلمات تخصصی مربوط به پروتکل DNS را تعریف می‌کند تا به‌عنوان غلط املایی نشان داده نشوند.  
محتوا:
```json
{
    "cSpell.words": [
        "ancount",
        "arcount",
        "nscount",
        "qdcount",
        "qtype",
        "rdlength",
        "SOCK_DGRAM",
        "AAAA"
    ]
}
```
این کلمات مربوط به متغیرها و اصطلاحات استفاده‌شده در کد هستند (مثل SOCK_DGRAM برای سوکت UDP).

#### requirements.txt
در حال حاضر خالی است، چون پروژه وابستگی خارجی ندارد:
```
# بدون وابستگی خارجی
```

#### .gitignore
فایل‌های غیرضروری (مثل فایل‌های موقت پایتون) را از آپلود به گیت‌هاب مستثنی می‌کند:
```
__pycache__/
*.pyc
*.log
```

## دستورات نصب و اجرا

### کلون کردن پروژه:
```bash
git clone https://github.com/argh94/DNSResolver.git
cd DNSResolver
```

### اجرای برنامه:
```bash
python dns_resolver.py
```

### ورودی برنامه:
وقتی برنامه اجرا می‌شود، از شما سه دامنه می‌خواهد (مثل google.com).  
برای هر دامنه، آدرس‌های IPv4 و IPv6 (اگر موجود باشد) را نمایش می‌دهد.

#### مثال اجرا

ورودی:
```
دامنه 1 را وارد کنید: google.com
دامنه 2 را وارد کنید: example.com
دامنه 3 را وارد کنید: invalid@domain
```

خروجی احتمالی:
```
آدرس IP برای google.com (A): 142.250.190.14
آدرس IP برای google.com (AAAA): 2607:f8b0:4004:831::200e
آدرس IP برای example.com (A): 93.184.216.34
آدرس IP برای example.com (AAAA): No response or failed to parse
آدرس IP برای invalid@domain (A): Invalid domain name
آدرس IP برای invalid@domain (AAAA): Invalid domain name
```

## دستورات فورک (Fork) پروژه

اگر می‌خواهید پروژه را فورک کنید و در مخزن خودتان تغییرات بدهید:

1. به صفحه مخزن بروید: https://github.com/argh94/DNSResolver
2. روی دکمه Fork (بالای صفحه سمت راست) کلیک کنید.
3. مخزن به حساب گیت‌هاب شما کپی می‌شود.
4. مخزن فورک‌شده را کلون کنید:
```bash
git clone https://github.com/YourUsername/DNSResolver.git
```
(به‌جای YourUsername، نام کاربری خودتان را قرار دهید.)

5. تغییرات را اعمال کنید، کامیت کنید و به مخزن خودتان push کنید:
```bash
git add .
git commit -m "تغییرات من"
git push origin main
```

اگر خواستید تغییرات را به مخزن اصلی (argh94) پیشنهاد دهید، می‌توانید یک Pull Request بفرستید.

## توسعه آینده

- اضافه کردن پشتیبانی از سرورهای DNS دیگر (مثل 8.8.8.8 از گوگل)
- پشتیبانی از انواع دیگر رکوردهای DNS (مثل CNAME یا MX)
- ذخیره نتایج در فایل (مثل JSON یا CSV)
- اضافه کردن رابط کاربری گرافیکی (مثلاً با tkinter)

## لایسنس

این پروژه تحت لایسنس MIT License (LICENSE) منتشر شده است.

## تماس

برای سؤال یا پیشنهاد، می‌توانید با argh94 از طریق گیت‌هاب تماس بگیرید.
